{% extends "base.html" %}

{% block content %}
  <div class="topbar">
    <div>
      <div style="font-weight: 700; font-size: 16px;">
        <a href="/topics/{{ topic_id }}" style="color: inherit; text-decoration: none;">{{ topic_id }}</a>
      </div>
      <div class="muted" style="font-size: 13px;">Digests</div>
    </div>
    <div class="muted" style="font-size: 13px;">Count: <code>{{ digests|length }}</code></div>
  </div>

  {% set page = 'digests' %}
  {% include "partials_topic_tabs.html" %}

  <form class="searchbar" method="get" action="/topics/{{ topic_id }}/digests">
    <input type="text" name="q" value="{{ q }}" placeholder="Search by title / tag / filename..." />
    <button type="submit">Search</button>
  </form>

  <div class="panel">
    <div class="list">
      {% for d in digests %}
        <div class="item">
          <h3><a href="/topics/{{ topic_id }}/digests/{{ d.filename }}">{{ d.title }}</a></h3>
          <div class="sub">
            <span class="pill">{{ d.filename }}</span>
            {% if d.published_at %}<span class="pill">{{ d.published_at }}</span>{% endif %}
            {% if d.source_type %}<span class="pill">{{ d.source_type }}</span>{% endif %}
            {% for tag in d.tags[:10] %}<span class="pill">{{ tag }}</span>{% endfor %}
            {% if d.tags|length > 10 %}<span class="pill">+{{ d.tags|length - 10 }}</span>{% endif %}
          </div>
        </div>
      {% endfor %}
      {% if digests|length == 0 %}
        <div class="muted">No digests found.</div>
      {% endif %}
    </div>
  </div>
{% endblock %}

