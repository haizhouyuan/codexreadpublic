# 隐私与留存策略（V1 草稿）

## 1. 目的

本策略用于约束本项目在处理以下敏感信息时的最小安全基线：

- 孩子相关对话与画像信息
- 个人投研与决策相关信息
- 任何凭证信息（API Key、Token、Cookie 等）

目标：

- 默认“最小化采集、最小化留存、最小化外泄风险”
- 支持“可追溯但不暴露原文”的审计与回放

## 2. 数据分级（建议）

- **P0：公开数据**（public）
  - 公开文章链接、公开研报标题、公开数据口径等。
- **P1：个人数据**（personal）
  - U1 的偏好、原则、任务标题（不含敏感细节）。
- **P2：敏感数据**（sensitive）
  - 投资账户/资金/交易细节；带有明确个人身份线索的信息。
- **P3：儿童敏感数据**（child_sensitive）
  - 孩子对话原文、情绪/行为画像、可识别信息（姓名、学校、住址等）。
- **CRED：凭证数据**（credentials）
  - 任何 API Key/Token/密码/会话信息。

## 3. 存放规则（默认）

### 3.1 `imports/`（原始输入，默认不入 Git）

- `imports/child/`：P3
  - **不入 Git**；仅本机/NAS 本地保存。
  - 默认不在其他产物中复制完整原文，只允许通过 `path + hash` 引用。
- `imports/content/`：P0/P1/P2（视内容而定）
  - 建议只存必要原文；长文可只保存链接与摘要。

### 3.2 `exports/`（结构化产物）

- `exports/robot-update-packages/`：P2/P3（通常）
  - 默认不包含原始对话逐字引用；
  - 若需提交到 Git，必须做脱敏处理（移除可识别信息、避免长引用）。
- `exports/digests/`：P0/P1（通常）
  - 优先写“总结与要点”，避免写入个人敏感信息。

### 3.3 `archives/topics/`（主题档案）

- 原则：可长期留存，可选择性入 Git。
- 不建议包含：
  - 可识别的孩子信息（P3）
  - 资金账户/交易细节（P2）

### 3.4 `state/` 与 `logs/`

- `state/`（例如 SQLite、缓存）：默认不入 Git。
- `logs/`：默认不入 Git；日志中尽量不要出现 P3 原文，只记录 hash/ID。
- 会话/调试输出（通常包含大量上下文，甚至可能包含 CRED）：
  - Codex 会话导出 Markdown、JSONL 备份等：默认放到 `state/` 或仓库外目录，并在 `.gitignore` 中强制忽略。
  - SpecStory 会话历史（如 `.specstory/history/`）：默认不入 Git。

### 3.5 凭证（CRED）

- 任何凭证只允许以环境变量/系统密钥链形式注入。
- 仓库中禁止出现：
  - `.env`（除非明确加入 `.gitignore` 且不提交）
  - 明文 key/token
  - 浏览器登录态导出文件（例如 Playwright `storage_state.json`、cookie dump 等）

## 4. 留存周期（建议默认，可配置）

> 具体保留多久取决于你对回溯需求与风险偏好；以下给出可用的默认值。

- `imports/child/`（P3 原文）：建议 **30 天** 滚动保留，超期手动或脚本清理。
- `exports/robot-update-packages/`（P3 摘要）：建议 **180 天** 或按“已审批包”长期保留（已脱敏前提下）。
- `exports/digests/` 与 `archives/topics/`：可长期保留（通常不含 P3/CRED）。
- `logs/`：建议 **30–90 天** 滚动保留。

## 5. 访问控制（建议）

- 在 NAS 上为本项目使用独立系统用户运行（例如 `aiagent`），仅授予项目目录权限。
- P3 数据目录建议设置更严格的权限（例如 `chmod 700 imports/child`）。
- 尽量避免通过公开共享链接/公共网盘分享包含 P2/P3 的产物。

## 6. 脱敏建议（P3/P2）

- 避免逐字引用孩子对话；改用转述与总结。
- 删除/替换可识别信息（姓名、学校、地名、联系方式）。
- 对少量关键引用，允许保留极短片段，但建议改写并降低可检索性。
